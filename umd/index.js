!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports):"function"==typeof define&&define.amd?define(["exports"],o):o((e=e||self).micoDb={})}(this,function(e){"use strict";function o(e){var i;function n(e,o,n){var t=window[e];o=a.name+a.version+"_"+o,"object"==typeof n?t.setItem(o,JSON.stringify(n)):t.setItem(o,n)}function o(e,o){var n=window[e].getItem(a.name+a.version+"_"+o);return!n||"["!==n[0]&&"{"!==n[0]?n:JSON.parse(n)}function t(e,o){window[e].removeItem(a.name+a.version+"_"+o)}function s(n){return new Promise(function(o){if(i)o(void 0);else{var e=window.indexedDB.open(a.name,a.version);e.onerror=console.error,e.onsuccess=function(e){i=i||e.target.result,o(void 0)},e.onupgradeneeded=function(e){(i=i||e.target.result).createObjectStore(n,{keyPath:"_id"})}}})}void 0===e&&(e="mico-db");var a={name:e,isHaveIndexedDb:void 0!==window.indexedDB,version:1,remove:function(t){return new Promise(function(o){if(!t)return o();if(!a.isHaveIndexedDb)return o(a.removeLocalStorage(t));var n=a.name+a.version;s(n).then(function(){if(i.objectStoreNames.contains(n)){var e=i.transaction([n],"readwrite").objectStore(n).delete(t);e.onerror=function(e){console.error(e),o(void 0)},e.onsuccess=o}else o(void 0)})})},get:function(o){return new Promise(function(n){if(!o)return n(void 0);if(!a.isHaveIndexedDb)return n(a.getLocalStorage(o));var e=a.name+a.version;s(e).then(function(){i.objectStoreNames.contains(e)?i.transaction([e]).objectStore(e).get(o).onsuccess=function(e){var o=e.target.result;n(o&&o.obj)}:n(void 0)})})},set:function(t,r){return new Promise(function(o){if(!t)return o(void 0);if(!a.isHaveIndexedDb)return o(a.setLocalStorage(t,r));var n=a.name+a.version;s(n).then(function(){if(i.objectStoreNames.contains(n)){var e=i.transaction([n],"readwrite").objectStore(n).put({obj:r,_id:t});e.onerror=function(e){console.error(e),o(void 0)},e.onsuccess=o}else o(void 0)})})},setLocalStorage:function(e,o){n("localStorage",e,o)},getLocalStorage:function(e){return o("localStorage",e)},removeLocalStorage:function(e){t("localStorage",e)},setSessionStorage:function(e,o){n("sessionStorage",e,o)},getSessionStorage:function(e){return o("sessionStorage",e)},removeSessionStorage:function(e){t("sessionStorage",e)}};return a}var n=o();e.createMicoDb=o,e.default=n,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
